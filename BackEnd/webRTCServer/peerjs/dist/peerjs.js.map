{
  "version": 3,
  "sources": ["../node_modules/peerjs-js-binarypack/lib/bufferbuilder.js", "../node_modules/peerjs-js-binarypack/lib/binarypack.js", "../node_modules/eventemitter3/index.js", "../lib/utils.ts", "../lib/peer.ts", "../lib/logger.ts", "../lib/socket.ts", "../lib/negotiator.ts", "../lib/baseconnection.ts", "../lib/mediaconnection.ts", "../lib/encodingQueue.ts", "../lib/dataconnection.ts", "../lib/api.ts", "../lib/supports.ts", "../lib/index.ts"],
  "sourcesContent": ["var binaryFeatures = {};\r\nbinaryFeatures.useBlobBuilder = (function () {\r\n  try {\r\n    new Blob([]);\r\n    return false;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n})();\r\n\r\nbinaryFeatures.useArrayBufferView = !binaryFeatures.useBlobBuilder && (function () {\r\n  try {\r\n    return (new Blob([new Uint8Array([])])).size === 0;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n})();\r\n\r\nmodule.exports.binaryFeatures = binaryFeatures;\r\nvar BlobBuilder = module.exports.BlobBuilder;\r\nif (typeof window !== 'undefined') {\r\n  BlobBuilder = module.exports.BlobBuilder = window.WebKitBlobBuilder ||\r\n    window.MozBlobBuilder || window.MSBlobBuilder || window.BlobBuilder;\r\n}\r\n\r\nfunction BufferBuilder () {\r\n  this._pieces = [];\r\n  this._parts = [];\r\n}\r\n\r\nBufferBuilder.prototype.append = function (data) {\r\n  if (typeof data === 'number') {\r\n    this._pieces.push(data);\r\n  } else {\r\n    this.flush();\r\n    this._parts.push(data);\r\n  }\r\n};\r\n\r\nBufferBuilder.prototype.flush = function () {\r\n  if (this._pieces.length > 0) {\r\n    var buf = new Uint8Array(this._pieces);\r\n    if (!binaryFeatures.useArrayBufferView) {\r\n      buf = buf.buffer;\r\n    }\r\n    this._parts.push(buf);\r\n    this._pieces = [];\r\n  }\r\n};\r\n\r\nBufferBuilder.prototype.getBuffer = function () {\r\n  this.flush();\r\n  if (binaryFeatures.useBlobBuilder) {\r\n    var builder = new BlobBuilder();\r\n    for (var i = 0, ii = this._parts.length; i < ii; i++) {\r\n      builder.append(this._parts[i]);\r\n    }\r\n    return builder.getBlob();\r\n  } else {\r\n    return new Blob(this._parts);\r\n  }\r\n};\r\n\r\nmodule.exports.BufferBuilder = BufferBuilder;\r\n", "var BufferBuilder = require('./bufferbuilder').BufferBuilder;\r\nvar binaryFeatures = require('./bufferbuilder').binaryFeatures;\r\n\r\nvar BinaryPack = {\r\n  unpack: function (data) {\r\n    var unpacker = new Unpacker(data);\r\n    return unpacker.unpack();\r\n  },\r\n  pack: function (data) {\r\n    var packer = new Packer();\r\n    packer.pack(data);\r\n    var buffer = packer.getBuffer();\r\n    return buffer;\r\n  }\r\n};\r\n\r\nmodule.exports = BinaryPack;\r\n\r\nfunction Unpacker (data) {\r\n  // Data is ArrayBuffer\r\n  this.index = 0;\r\n  this.dataBuffer = data;\r\n  this.dataView = new Uint8Array(this.dataBuffer);\r\n  this.length = this.dataBuffer.byteLength;\r\n}\r\n\r\nUnpacker.prototype.unpack = function () {\r\n  var type = this.unpack_uint8();\r\n  if (type < 0x80) {\r\n    return type;\r\n  } else if ((type ^ 0xe0) < 0x20) {\r\n    return (type ^ 0xe0) - 0x20;\r\n  }\r\n\r\n  var size;\r\n  if ((size = type ^ 0xa0) <= 0x0f) {\r\n    return this.unpack_raw(size);\r\n  } else if ((size = type ^ 0xb0) <= 0x0f) {\r\n    return this.unpack_string(size);\r\n  } else if ((size = type ^ 0x90) <= 0x0f) {\r\n    return this.unpack_array(size);\r\n  } else if ((size = type ^ 0x80) <= 0x0f) {\r\n    return this.unpack_map(size);\r\n  }\r\n\r\n  switch (type) {\r\n    case 0xc0:\r\n      return null;\r\n    case 0xc1:\r\n      return undefined;\r\n    case 0xc2:\r\n      return false;\r\n    case 0xc3:\r\n      return true;\r\n    case 0xca:\r\n      return this.unpack_float();\r\n    case 0xcb:\r\n      return this.unpack_double();\r\n    case 0xcc:\r\n      return this.unpack_uint8();\r\n    case 0xcd:\r\n      return this.unpack_uint16();\r\n    case 0xce:\r\n      return this.unpack_uint32();\r\n    case 0xcf:\r\n      return this.unpack_uint64();\r\n    case 0xd0:\r\n      return this.unpack_int8();\r\n    case 0xd1:\r\n      return this.unpack_int16();\r\n    case 0xd2:\r\n      return this.unpack_int32();\r\n    case 0xd3:\r\n      return this.unpack_int64();\r\n    case 0xd4:\r\n      return undefined;\r\n    case 0xd5:\r\n      return undefined;\r\n    case 0xd6:\r\n      return undefined;\r\n    case 0xd7:\r\n      return undefined;\r\n    case 0xd8:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_string(size);\r\n    case 0xd9:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_string(size);\r\n    case 0xda:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_raw(size);\r\n    case 0xdb:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_raw(size);\r\n    case 0xdc:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_array(size);\r\n    case 0xdd:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_array(size);\r\n    case 0xde:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_map(size);\r\n    case 0xdf:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_map(size);\r\n  }\r\n};\r\n\r\nUnpacker.prototype.unpack_uint8 = function () {\r\n  var byte = this.dataView[this.index] & 0xff;\r\n  this.index++;\r\n  return byte;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint16 = function () {\r\n  var bytes = this.read(2);\r\n  var uint16 =\r\n    ((bytes[0] & 0xff) * 256) + (bytes[1] & 0xff);\r\n  this.index += 2;\r\n  return uint16;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint32 = function () {\r\n  var bytes = this.read(4);\r\n  var uint32 =\r\n    ((bytes[0] * 256 +\r\n      bytes[1]) * 256 +\r\n      bytes[2]) * 256 +\r\n    bytes[3];\r\n  this.index += 4;\r\n  return uint32;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint64 = function () {\r\n  var bytes = this.read(8);\r\n  var uint64 =\r\n    ((((((bytes[0] * 256 +\r\n      bytes[1]) * 256 +\r\n      bytes[2]) * 256 +\r\n      bytes[3]) * 256 +\r\n      bytes[4]) * 256 +\r\n      bytes[5]) * 256 +\r\n      bytes[6]) * 256 +\r\n    bytes[7];\r\n  this.index += 8;\r\n  return uint64;\r\n};\r\n\r\nUnpacker.prototype.unpack_int8 = function () {\r\n  var uint8 = this.unpack_uint8();\r\n  return (uint8 < 0x80) ? uint8 : uint8 - (1 << 8);\r\n};\r\n\r\nUnpacker.prototype.unpack_int16 = function () {\r\n  var uint16 = this.unpack_uint16();\r\n  return (uint16 < 0x8000) ? uint16 : uint16 - (1 << 16);\r\n};\r\n\r\nUnpacker.prototype.unpack_int32 = function () {\r\n  var uint32 = this.unpack_uint32();\r\n  return (uint32 < Math.pow(2, 31)) ? uint32\r\n    : uint32 - Math.pow(2, 32);\r\n};\r\n\r\nUnpacker.prototype.unpack_int64 = function () {\r\n  var uint64 = this.unpack_uint64();\r\n  return (uint64 < Math.pow(2, 63)) ? uint64\r\n    : uint64 - Math.pow(2, 64);\r\n};\r\n\r\nUnpacker.prototype.unpack_raw = function (size) {\r\n  if (this.length < this.index + size) {\r\n    throw new Error('BinaryPackFailure: index is out of range' +\r\n      ' ' + this.index + ' ' + size + ' ' + this.length);\r\n  }\r\n  var buf = this.dataBuffer.slice(this.index, this.index + size);\r\n  this.index += size;\r\n\r\n  // buf = util.bufferToString(buf);\r\n\r\n  return buf;\r\n};\r\n\r\nUnpacker.prototype.unpack_string = function (size) {\r\n  var bytes = this.read(size);\r\n  var i = 0;\r\n  var str = '';\r\n  var c;\r\n  var code;\r\n\r\n  while (i < size) {\r\n    c = bytes[i];\r\n    if (c < 128) {\r\n      str += String.fromCharCode(c);\r\n      i++;\r\n    } else if ((c ^ 0xc0) < 32) {\r\n      code = ((c ^ 0xc0) << 6) | (bytes[i + 1] & 63);\r\n      str += String.fromCharCode(code);\r\n      i += 2;\r\n    } else {\r\n      code = ((c & 15) << 12) | ((bytes[i + 1] & 63) << 6) |\r\n        (bytes[i + 2] & 63);\r\n      str += String.fromCharCode(code);\r\n      i += 3;\r\n    }\r\n  }\r\n\r\n  this.index += size;\r\n  return str;\r\n};\r\n\r\nUnpacker.prototype.unpack_array = function (size) {\r\n  var objects = new Array(size);\r\n  for (var i = 0; i < size; i++) {\r\n    objects[i] = this.unpack();\r\n  }\r\n  return objects;\r\n};\r\n\r\nUnpacker.prototype.unpack_map = function (size) {\r\n  var map = {};\r\n  for (var i = 0; i < size; i++) {\r\n    var key = this.unpack();\r\n    var value = this.unpack();\r\n    map[key] = value;\r\n  }\r\n  return map;\r\n};\r\n\r\nUnpacker.prototype.unpack_float = function () {\r\n  var uint32 = this.unpack_uint32();\r\n  var sign = uint32 >> 31;\r\n  var exp = ((uint32 >> 23) & 0xff) - 127;\r\n  var fraction = (uint32 & 0x7fffff) | 0x800000;\r\n  return (sign === 0 ? 1 : -1) *\r\n    fraction * Math.pow(2, exp - 23);\r\n};\r\n\r\nUnpacker.prototype.unpack_double = function () {\r\n  var h32 = this.unpack_uint32();\r\n  var l32 = this.unpack_uint32();\r\n  var sign = h32 >> 31;\r\n  var exp = ((h32 >> 20) & 0x7ff) - 1023;\r\n  var hfrac = (h32 & 0xfffff) | 0x100000;\r\n  var frac = hfrac * Math.pow(2, exp - 20) +\r\n    l32 * Math.pow(2, exp - 52);\r\n  return (sign === 0 ? 1 : -1) * frac;\r\n};\r\n\r\nUnpacker.prototype.read = function (length) {\r\n  var j = this.index;\r\n  if (j + length <= this.length) {\r\n    return this.dataView.subarray(j, j + length);\r\n  } else {\r\n    throw new Error('BinaryPackFailure: read index out of range');\r\n  }\r\n};\r\n\r\nfunction Packer () {\r\n  this.bufferBuilder = new BufferBuilder();\r\n}\r\n\r\nPacker.prototype.getBuffer = function () {\r\n  return this.bufferBuilder.getBuffer();\r\n};\r\n\r\nPacker.prototype.pack = function (value) {\r\n  var type = typeof (value);\r\n  if (type === 'string') {\r\n    this.pack_string(value);\r\n  } else if (type === 'number') {\r\n    if (Math.floor(value) === value) {\r\n      this.pack_integer(value);\r\n    } else {\r\n      this.pack_double(value);\r\n    }\r\n  } else if (type === 'boolean') {\r\n    if (value === true) {\r\n      this.bufferBuilder.append(0xc3);\r\n    } else if (value === false) {\r\n      this.bufferBuilder.append(0xc2);\r\n    }\r\n  } else if (type === 'undefined') {\r\n    this.bufferBuilder.append(0xc0);\r\n  } else if (type === 'object') {\r\n    if (value === null) {\r\n      this.bufferBuilder.append(0xc0);\r\n    } else {\r\n      var constructor = value.constructor;\r\n      if (constructor == Array) {\r\n        this.pack_array(value);\r\n      } else if (constructor == Blob || constructor == File || value instanceof Blob || value instanceof File) {\r\n        this.pack_bin(value);\r\n      } else if (constructor == ArrayBuffer) {\r\n        if (binaryFeatures.useArrayBufferView) {\r\n          this.pack_bin(new Uint8Array(value));\r\n        } else {\r\n          this.pack_bin(value);\r\n        }\r\n      } else if ('BYTES_PER_ELEMENT' in value) {\r\n        if (binaryFeatures.useArrayBufferView) {\r\n          this.pack_bin(new Uint8Array(value.buffer));\r\n        } else {\r\n          this.pack_bin(value.buffer);\r\n        }\r\n      } else if ((constructor == Object) || (constructor.toString().startsWith('class'))) {\r\n        this.pack_object(value);\r\n      } else if (constructor == Date) {\r\n        this.pack_string(value.toString());\r\n      } else if (typeof value.toBinaryPack === 'function') {\r\n        this.bufferBuilder.append(value.toBinaryPack());\r\n      } else {\r\n        throw new Error('Type \"' + constructor.toString() + '\" not yet supported');\r\n      }\r\n    }\r\n  } else {\r\n    throw new Error('Type \"' + type + '\" not yet supported');\r\n  }\r\n  this.bufferBuilder.flush();\r\n};\r\n\r\nPacker.prototype.pack_bin = function (blob) {\r\n  var length = blob.length || blob.byteLength || blob.size;\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0xa0 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xda);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xdb);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  this.bufferBuilder.append(blob);\r\n};\r\n\r\nPacker.prototype.pack_string = function (str) {\r\n  var length = utf8Length(str);\r\n\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0xb0 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xd8);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xd9);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  this.bufferBuilder.append(str);\r\n};\r\n\r\nPacker.prototype.pack_array = function (ary) {\r\n  var length = ary.length;\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0x90 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xdc);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xdd);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  for (var i = 0; i < length; i++) {\r\n    this.pack(ary[i]);\r\n  }\r\n};\r\n\r\nPacker.prototype.pack_integer = function (num) {\r\n  if (num >= -0x20 && num <= 0x7f) {\r\n    this.bufferBuilder.append(num & 0xff);\r\n  } else if (num >= 0x00 && num <= 0xff) {\r\n    this.bufferBuilder.append(0xcc);\r\n    this.pack_uint8(num);\r\n  } else if (num >= -0x80 && num <= 0x7f) {\r\n    this.bufferBuilder.append(0xd0);\r\n    this.pack_int8(num);\r\n  } else if (num >= 0x0000 && num <= 0xffff) {\r\n    this.bufferBuilder.append(0xcd);\r\n    this.pack_uint16(num);\r\n  } else if (num >= -0x8000 && num <= 0x7fff) {\r\n    this.bufferBuilder.append(0xd1);\r\n    this.pack_int16(num);\r\n  } else if (num >= 0x00000000 && num <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xce);\r\n    this.pack_uint32(num);\r\n  } else if (num >= -0x80000000 && num <= 0x7fffffff) {\r\n    this.bufferBuilder.append(0xd2);\r\n    this.pack_int32(num);\r\n  } else if (num >= -0x8000000000000000 && num <= 0x7FFFFFFFFFFFFFFF) {\r\n    this.bufferBuilder.append(0xd3);\r\n    this.pack_int64(num);\r\n  } else if (num >= 0x0000000000000000 && num <= 0xFFFFFFFFFFFFFFFF) {\r\n    this.bufferBuilder.append(0xcf);\r\n    this.pack_uint64(num);\r\n  } else {\r\n    throw new Error('Invalid integer');\r\n  }\r\n};\r\n\r\nPacker.prototype.pack_double = function (num) {\r\n  var sign = 0;\r\n  if (num < 0) {\r\n    sign = 1;\r\n    num = -num;\r\n  }\r\n  var exp = Math.floor(Math.log(num) / Math.LN2);\r\n  var frac0 = num / Math.pow(2, exp) - 1;\r\n  var frac1 = Math.floor(frac0 * Math.pow(2, 52));\r\n  var b32 = Math.pow(2, 32);\r\n  var h32 = (sign << 31) | ((exp + 1023) << 20) |\r\n    (frac1 / b32) & 0x0fffff;\r\n  var l32 = frac1 % b32;\r\n  this.bufferBuilder.append(0xcb);\r\n  this.pack_int32(h32);\r\n  this.pack_int32(l32);\r\n};\r\n\r\nPacker.prototype.pack_object = function (obj) {\r\n  var keys = Object.keys(obj);\r\n  var length = keys.length;\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0x80 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xde);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xdf);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  for (var prop in obj) {\r\n    if (obj.hasOwnProperty(prop)) {\r\n      this.pack(prop);\r\n      this.pack(obj[prop]);\r\n    }\r\n  }\r\n};\r\n\r\nPacker.prototype.pack_uint8 = function (num) {\r\n  this.bufferBuilder.append(num);\r\n};\r\n\r\nPacker.prototype.pack_uint16 = function (num) {\r\n  this.bufferBuilder.append(num >> 8);\r\n  this.bufferBuilder.append(num & 0xff);\r\n};\r\n\r\nPacker.prototype.pack_uint32 = function (num) {\r\n  var n = num & 0xffffffff;\r\n  this.bufferBuilder.append((n & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((n & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((n & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((n & 0x000000ff));\r\n};\r\n\r\nPacker.prototype.pack_uint64 = function (num) {\r\n  var high = num / Math.pow(2, 32);\r\n  var low = num % Math.pow(2, 32);\r\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((high & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((high & 0x000000ff));\r\n  this.bufferBuilder.append((low & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((low & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((low & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((low & 0x000000ff));\r\n};\r\n\r\nPacker.prototype.pack_int8 = function (num) {\r\n  this.bufferBuilder.append(num & 0xff);\r\n};\r\n\r\nPacker.prototype.pack_int16 = function (num) {\r\n  this.bufferBuilder.append((num & 0xff00) >> 8);\r\n  this.bufferBuilder.append(num & 0xff);\r\n};\r\n\r\nPacker.prototype.pack_int32 = function (num) {\r\n  this.bufferBuilder.append((num >>> 24) & 0xff);\r\n  this.bufferBuilder.append((num & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((num & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((num & 0x000000ff));\r\n};\r\n\r\nPacker.prototype.pack_int64 = function (num) {\r\n  var high = Math.floor(num / Math.pow(2, 32));\r\n  var low = num % Math.pow(2, 32);\r\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((high & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((high & 0x000000ff));\r\n  this.bufferBuilder.append((low & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((low & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((low & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((low & 0x000000ff));\r\n};\r\n\r\nfunction _utf8Replace (m) {\r\n  var code = m.charCodeAt(0);\r\n\r\n  if (code <= 0x7ff) return '00';\r\n  if (code <= 0xffff) return '000';\r\n  if (code <= 0x1fffff) return '0000';\r\n  if (code <= 0x3ffffff) return '00000';\r\n  return '000000';\r\n}\r\n\r\nfunction utf8Length (str) {\r\n  if (str.length > 600) {\r\n    // Blob method faster for large strings\r\n    return (new Blob([str])).size;\r\n  } else {\r\n    return str.replace(/[^\\u0000-\\u007F]/g, _utf8Replace).length;\r\n  }\r\n}\r\n", "'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n", "import * as BinaryPack from 'peerjs-js-binarypack';\n\nconst DEFAULT_CONFIG = {\n  iceServers: [\n    { urls: 'stun:stun.l.google.com:19302' },\n    { urls: 'turn:0.peerjs.com:3478', username: 'peerjs', credential: 'peerjsp' },\n  ],\n  sdpSemantics: 'unified-plan',\n};\n\nexport const Utils = new (class {\n  readonly CLOUD_HOST = '0.peerjs.com';\n  readonly CLOUD_PORT = 443;\n\n  readonly chunkedMTU = 16300; // The original 60000 bytes setting does not work when sending data from Firefox to Chrome, which is \"cut off\" after 16384 bytes and delivered individually.\n\n  // Returns browser-agnostic default config\n  readonly defaultConfig = DEFAULT_CONFIG;\n\n  // Ensure alphanumeric ids\n  validateId(id: string): boolean {\n    // Allow empty ids\n    return !id || /^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(id);\n  }\n\n  pack = BinaryPack.pack;\n  unpack = BinaryPack.unpack;\n\n  // Binary stuff\n\n  private _dataCount: number = 1;\n\n  chunk(blob: Blob): { __peerData: number; n: number; total: number; data: Blob }[] {\n    const chunks = [];\n    const size = blob.size;\n    const total = Math.ceil(size / Utils.chunkedMTU);\n\n    let index = 0;\n    let start = 0;\n\n    while (start < size) {\n      const end = Math.min(size, start + Utils.chunkedMTU);\n      const b = blob.slice(start, end);\n\n      const chunk = {\n        __peerData: this._dataCount,\n        n: index,\n        data: b,\n        total,\n      };\n\n      chunks.push(chunk);\n\n      start = end;\n      index++;\n    }\n\n    this._dataCount++;\n\n    return chunks;\n  }\n\n  blobToArrayBuffer(FileReaderCtr: typeof FileReader, blob: Blob, cb: (arg: ArrayBuffer | null) => void): FileReader {\n    const fr = new FileReaderCtr();\n\n    fr.onload = function (evt) {\n      if (evt.target) {\n        cb(evt.target.result as ArrayBuffer);\n      }\n    };\n\n    fr.readAsArrayBuffer(blob);\n\n    return fr;\n  }\n\n  binaryStringToArrayBuffer(binary: string): ArrayBuffer | SharedArrayBuffer {\n    const byteArray = new Uint8Array(binary.length);\n\n    for (let i = 0; i < binary.length; i++) {\n      byteArray[i] = binary.charCodeAt(i) & 0xff;\n    }\n\n    return byteArray.buffer;\n  }\n\n  randomToken(): string {\n    return Math.random().toString(36).substr(2);\n  }\n\n  isSecure(): boolean {\n    return location.protocol === 'https:';\n  }\n})();\n", "import { EventEmitter } from 'eventemitter3';\nimport { Utils } from './utils';\nimport logger, { LogLevel } from './logger';\nimport { Socket } from './socket';\nimport { MediaConnection } from './mediaconnection';\nimport { DataConnection } from './dataconnection';\nimport { ConnectionType, PeerErrorType, PeerEventType, SocketEventType, ServerMessageType } from './enums';\nimport { BaseConnection } from './baseconnection';\nimport { ServerMessage } from './servermessage';\nimport { API } from './api';\nimport type { PeerConnectOption, PeerJSOption, Features } from '..';\nimport { Supports } from './supports';\n\ninterface PeerOptions extends PeerJSOption {\n  debug?: LogLevel; // 1: Errors, 2: Warnings, 3: All logs\n  logFunction?: (logLevel: LogLevel, ...rest: any[]) => void;\n}\n\n/**\n * A peer who can initiate connections with other peers.\n */\nexport class Peer extends EventEmitter {\n  private static readonly DEFAULT_KEY = 'peerjs';\n\n  private readonly _options: PeerOptions;\n  private readonly _api: API;\n  private readonly _socket: Socket;\n\n  private _id: string | null = null;\n  private _lastServerId: string | null = null;\n\n  // States.\n  private _destroyed = false; // Connections have been killed\n  private _disconnected = false; // Connection to PeerServer killed but P2P connections still active\n  private _open = false; // Sockets and such are not yet open.\n  private readonly _connections: Map<string, BaseConnection[]> = new Map(); // All connections for this peer.\n  private readonly _lostMessages: Map<string, ServerMessage[]> = new Map(); // src => [list of messages]\n\n  get id() {\n    return this._id;\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  get open() {\n    return this._open;\n  }\n\n  get socket() {\n    return this._socket;\n  }\n\n  /**\n   * @deprecated\n   * Return type will change from Object to Map<string,[]>\n   */\n  get connections(): Object {\n    const plainConnections = Object.create(null);\n\n    for (let [k, v] of this._connections) {\n      plainConnections[k] = v;\n    }\n\n    return plainConnections;\n  }\n\n  get destroyed() {\n    return this._destroyed;\n  }\n  get disconnected() {\n    return this._disconnected;\n  }\n\n  readonly features: Features;\n\n  constructor(id?: string | PeerOptions, options?: PeerOptions) {\n    super();\n\n    let userId: string | undefined;\n\n    // Deal with overloading\n    if (id && id.constructor == Object) {\n      options = id as PeerOptions;\n    } else if (id) {\n      userId = id.toString();\n    }\n\n    // Configure options\n    options = {\n      debug: 0, // 1: Errors, 2: Warnings, 3: All logs\n      host: Utils.CLOUD_HOST,\n      port: Utils.CLOUD_PORT,\n      path: '/',\n      key: Peer.DEFAULT_KEY,\n      token: Utils.randomToken(),\n      config: Utils.defaultConfig,\n      ...options,\n    };\n    this._options = options;\n\n    // Detect relative URL host.\n    if (typeof window !== 'undefined' && this._options.host === '/') {\n      this._options.host = window.location.hostname;\n    }\n\n    // Set path correctly.\n    if (this._options.path) {\n      if (this._options.path[0] !== '/') {\n        this._options.path = '/' + this._options.path;\n      }\n      if (this._options.path[this._options.path.length - 1] !== '/') {\n        this._options.path += '/';\n      }\n    }\n\n    // Set whether we use SSL to same as current host\n    if (this._options.secure === undefined && this._options.host !== Utils.CLOUD_HOST) {\n      this._options.secure = Utils.isSecure();\n    } else if (this._options.host == Utils.CLOUD_HOST) {\n      this._options.secure = true;\n    }\n    // Set a custom log function if present\n    if (this._options.logFunction) {\n      logger.setLogFunction(this._options.logFunction);\n    }\n\n    logger.logLevel = this._options.debug || 0;\n\n    this._api = new API(options);\n    this._socket = this._createServerConnection();\n\n    this.features = Peer.getFeatures(this._options.polyfills?.WebRTC);\n\n    // Sanity checks\n    // Ensure WebRTC supported\n    if (!this.features.audioVideo && !this.features.data) {\n      this._delayedAbort(PeerErrorType.BrowserIncompatible, 'The current browser does not support WebRTC');\n      return;\n    }\n\n    // Ensure alphanumeric id\n    if (!!userId && !Utils.validateId(userId)) {\n      this._delayedAbort(PeerErrorType.InvalidID, `ID \"${userId}\" is invalid`);\n      return;\n    }\n\n    this.socket.alive = true;\n\n    if (userId) {\n      this._initialize(userId);\n    } else {\n      this._api\n        .retrieveId()\n        .then(id => this._initialize(id))\n        .catch(error => this._abort(PeerErrorType.ServerError, error));\n    }\n  }\n\n  private _createServerConnection(): Socket {\n    const socket = new Socket(this._options);\n\n    socket.on(SocketEventType.Message, (data: ServerMessage) => {\n      this._handleMessage(data);\n    });\n\n    socket.on(SocketEventType.Error, (error: string) => {\n      this._abort(PeerErrorType.SocketError, error);\n    });\n\n    socket.on(SocketEventType.Disconnected, () => {\n      if (this.disconnected) {\n        return;\n      }\n\n      this.emitError(PeerErrorType.Network, 'Lost connection to server.');\n      this.disconnect();\n    });\n\n    socket.on(SocketEventType.Close, () => {\n      if (this.disconnected) {\n        return;\n      }\n\n      this._abort(PeerErrorType.SocketClosed, 'Underlying socket is already closed.');\n    });\n\n    return socket;\n  }\n\n  /** Initialize a connection with the server. */\n  private _initialize(id: string): void {\n    if (this.destroyed) return;\n\n    this._id = id;\n    this.socket.start(id, this._options.token!);\n  }\n\n  /** Handles messages from the server. */\n  private _handleMessage(message: ServerMessage): void {\n    const type = message.type;\n    const payload = message.payload;\n    const peerId = message.src;\n\n    switch (type) {\n      case ServerMessageType.Open: // The connection to the server is open.\n        this._lastServerId = this.id;\n        this._open = true;\n        this.emit(PeerEventType.Open, this.id);\n        break;\n      case ServerMessageType.Error: // Server error.\n        this._abort(PeerErrorType.ServerError, payload.msg);\n        break;\n      case ServerMessageType.IdTaken: // The selected ID is taken.\n        this._abort(PeerErrorType.UnavailableID, `ID \"${this.id}\" is taken`);\n        break;\n      case ServerMessageType.InvalidKey: // The given API key cannot be found.\n        this._abort(PeerErrorType.InvalidKey, `API KEY \"${this._options.key}\" is invalid`);\n        break;\n      case ServerMessageType.Leave: // Another peer has closed its connection to this peer.\n        logger.log(`Received leave message from ${peerId}`);\n        this._cleanupPeer(peerId);\n        this._connections.delete(peerId);\n        break;\n      case ServerMessageType.Expire: // The offer sent to a peer has expired without response.\n        this.emitError(PeerErrorType.PeerUnavailable, `Could not connect to peer ${peerId}`);\n        break;\n      case ServerMessageType.Offer: {\n        // we should consider switching this to CALL/CONNECT, but this is the least breaking option.\n        const connectionId = payload.connectionId;\n        let connection = this.getConnection(peerId, connectionId);\n\n        if (connection) {\n          connection.close();\n          logger.warn(`Offer received for existing Connection ID:${connectionId}`);\n        }\n\n        // Create a new connection.\n        if (payload.type === ConnectionType.Media) {\n          connection = new MediaConnection(peerId, this, {\n            connectionId: connectionId,\n            _payload: payload,\n            metadata: payload.metadata,\n          });\n          this._addConnection(peerId, connection);\n          this.emit(PeerEventType.Call, connection);\n        } else if (payload.type === ConnectionType.Data) {\n          connection = new DataConnection(peerId, this, {\n            connectionId: connectionId,\n            _payload: payload,\n            metadata: payload.metadata,\n            label: payload.label,\n            serialization: payload.serialization,\n            reliable: payload.reliable,\n          });\n          this._addConnection(peerId, connection);\n          this.emit(PeerEventType.Connection, connection);\n        } else {\n          logger.warn(`Received malformed connection type:${payload.type}`);\n          return;\n        }\n\n        // Find messages.\n        const messages = this._getMessages(connectionId);\n        for (let message of messages) {\n          connection.handleMessage(message);\n        }\n\n        break;\n      }\n      default: {\n        if (!payload) {\n          logger.warn(`You received a malformed message from ${peerId} of type ${type}`);\n          return;\n        }\n\n        const connectionId = payload.connectionId;\n        const connection = this.getConnection(peerId, connectionId);\n\n        if (connection && connection.peerConnection) {\n          // Pass it on.\n          connection.handleMessage(message);\n        } else if (connectionId) {\n          // Store for possible later use\n          this._storeMessage(connectionId, message);\n        } else {\n          logger.warn('You received an unrecognized message:', message);\n        }\n        break;\n      }\n    }\n  }\n\n  /** Stores messages without a set up connection, to be claimed later. */\n  private _storeMessage(connectionId: string, message: ServerMessage): void {\n    if (!this._lostMessages.has(connectionId)) {\n      this._lostMessages.set(connectionId, []);\n    }\n\n    this._lostMessages.get(connectionId).push(message);\n  }\n\n  /** Retrieve messages from lost message store */\n  //TODO Change it to private\n  public _getMessages(connectionId: string): ServerMessage[] {\n    const messages = this._lostMessages.get(connectionId);\n\n    if (messages) {\n      this._lostMessages.delete(connectionId);\n      return messages;\n    }\n\n    return [];\n  }\n\n  /**\n   * Returns a DataConnection to the specified peer. See documentation for a\n   * complete list of options.\n   */\n  connect(peer: string, options: PeerConnectOption = {}): DataConnection {\n    if (this.disconnected) {\n      logger.warn(\n        'You cannot connect to a new Peer because you called ' +\n          '.disconnect() on this Peer and ended your connection with the ' +\n          'server. You can create a new Peer to reconnect, or call reconnect ' +\n          'on this peer if you believe its ID to still be available.'\n      );\n      this.emitError(PeerErrorType.Disconnected, 'Cannot connect to new Peer after disconnecting from server.');\n      return;\n    }\n\n    const dataConnection = new DataConnection(peer, this, options);\n    this._addConnection(peer, dataConnection);\n    return dataConnection;\n  }\n\n  /**\n   * Returns a MediaConnection to the specified peer. See documentation for a\n   * complete list of options.\n   */\n  call(peer: string, stream: MediaStream, options: any = {}): MediaConnection {\n    if (this.disconnected) {\n      logger.warn(\n        'You cannot connect to a new Peer because you called ' +\n          '.disconnect() on this Peer and ended your connection with the ' +\n          'server. You can create a new Peer to reconnect.'\n      );\n      this.emitError(PeerErrorType.Disconnected, 'Cannot connect to new Peer after disconnecting from server.');\n      return;\n    }\n\n    if (!stream) {\n      logger.error(\"To call a peer, you must provide a stream from your browser's `getUserMedia`.\");\n      return;\n    }\n\n    options._stream = stream;\n\n    const mediaConnection = new MediaConnection(peer, this, options);\n    this._addConnection(peer, mediaConnection);\n    return mediaConnection;\n  }\n\n  /** Add a data/media connection to this peer. */\n  private _addConnection(peerId: string, connection: BaseConnection): void {\n    logger.log(`add connection ${connection.type}:${connection.connectionId} to peerId:${peerId}`);\n\n    if (!this._connections.has(peerId)) {\n      this._connections.set(peerId, []);\n    }\n    this._connections.get(peerId).push(connection);\n  }\n\n  //TODO should be private\n  _removeConnection(connection: BaseConnection): void {\n    const connections = this._connections.get(connection.peer);\n\n    if (connections) {\n      const index = connections.indexOf(connection);\n\n      if (index !== -1) {\n        connections.splice(index, 1);\n\n        if (connections.length === 0) {\n          this._connections.delete(connection.peer);\n        }\n      }\n    }\n\n    //remove from lost messages\n    this._lostMessages.delete(connection.connectionId);\n  }\n\n  /** Retrieve a data/media connection for this peer. */\n  getConnection(peerId: string, connectionId: string): null | BaseConnection {\n    const connections = this._connections.get(peerId);\n    if (!connections) {\n      return null;\n    }\n\n    for (let connection of connections) {\n      if (connection.connectionId === connectionId) {\n        return connection;\n      }\n    }\n\n    return null;\n  }\n\n  private _delayedAbort(type: PeerErrorType, message: string | Error): void {\n    setTimeout(() => {\n      this._abort(type, message);\n    }, 0);\n  }\n\n  /**\n   * Emits an error message and destroys the Peer.\n   * The Peer is not destroyed if it's in a disconnected state, in which case\n   * it retains its disconnected state and its existing connections.\n   */\n  private _abort(type: PeerErrorType, message: string | Error): void {\n    logger.error('Aborting!');\n\n    this.emitError(type, message);\n\n    if (!this._lastServerId) {\n      this.destroy();\n    } else {\n      this.disconnect();\n    }\n  }\n\n  /** Emits a typed error message. */\n  emitError(type: PeerErrorType, err: string | Error): void {\n    logger.error('Error:', err);\n\n    let error: Error & { type?: PeerErrorType };\n\n    if (typeof err === 'string') {\n      error = new Error(err);\n    } else {\n      error = err as Error;\n    }\n\n    error.type = type;\n\n    this.emit(PeerEventType.Error, error);\n  }\n\n  /**\n   * Destroys the Peer: closes all active connections as well as the connection\n   *  to the server.\n   * Warning: The peer can no longer create or accept connections after being\n   *  destroyed.\n   */\n  destroy(): void {\n    if (this.destroyed) {\n      return;\n    }\n\n    logger.log(`Destroy peer with ID:${this.id}`);\n\n    this.disconnect();\n    this._cleanup();\n\n    this.socket.destroy();\n\n    this._destroyed = true;\n\n    this.emit(PeerEventType.Close);\n  }\n\n  /** Disconnects every connection on this peer. */\n  private _cleanup(): void {\n    for (let peerId of this._connections.keys()) {\n      this._cleanupPeer(peerId);\n      this._connections.delete(peerId);\n    }\n\n    this.socket.removeAllListeners();\n  }\n\n  /** Closes all connections to this peer. */\n  private _cleanupPeer(peerId: string): void {\n    const connections = this._connections.get(peerId);\n\n    if (!connections) return;\n\n    for (let connection of connections) {\n      connection.close();\n    }\n  }\n\n  /**\n   * Disconnects the Peer's connection to the PeerServer. Does not close any\n   *  active connections.\n   * Warning: The peer can no longer create or accept connections after being\n   *  disconnected. It also cannot reconnect to the server.\n   */\n  disconnect(): void {\n    if (this.disconnected) {\n      return;\n    }\n\n    const currentId = this.id;\n\n    logger.log(`Disconnect peer with ID:${currentId}`);\n\n    this._disconnected = true;\n    this._open = false;\n\n    this.socket.alive = false;\n    this.socket.close();\n\n    this._lastServerId = currentId;\n    this._id = null;\n\n    this.emit(PeerEventType.Disconnected, currentId);\n  }\n\n  /** Attempts to reconnect with the same ID. */\n  reconnect(): void {\n    if (this.disconnected && !this.destroyed) {\n      logger.log(`Attempting reconnection to server with ID ${this._lastServerId}`);\n      this._disconnected = false;\n      this.socket.alive = true;\n      this._initialize(this._lastServerId!);\n    } else if (this.destroyed) {\n      throw new Error('This peer cannot reconnect to the server. It has already been destroyed.');\n    } else if (!this.disconnected && !this.open) {\n      // Do nothing. We're still connecting the first time.\n      logger.error(\"In a hurry? We're still trying to make the initial connection!\");\n    } else {\n      throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`);\n    }\n  }\n\n  /**\n   * Get a list of available peer IDs. If you're running your own server, you'll\n   * want to set allow_discovery: true in the PeerServer options. If you're using\n   * the cloud server, email team@peerjs.com to get the functionality enabled for\n   * your key.\n   */\n  listAllPeers(cb = (_: any[]) => {}): void {\n    this._api\n      .listAllPeers()\n      .then(peers => cb(peers))\n      .catch(error => this._abort(PeerErrorType.ServerError, error));\n  }\n\n  static getFeatures(webRtc: any): Features {\n    if (!webRtc && typeof window !== 'undefined') {\n      webRtc = window;\n    }\n\n    if (!Peer._features) {\n      Peer._features = Peer.checkFeatures(webRtc);\n    }\n\n    return Peer._features;\n  }\n\n  private static _features?: Features;\n\n  // Lists which features are supported\n  private static checkFeatures(webRtc: any): Features {\n    if (!webRtc && typeof window !== 'undefined') {\n      webRtc = window;\n    }\n\n    const supported: Features = {\n      webRTC: typeof webRtc.RTCPeerConnection !== 'undefined',\n      audioVideo: true,\n      data: false,\n      binaryBlob: false,\n      reliable: false,\n      unifiedPlan: false,\n    };\n\n    if (!supported.webRTC) return supported;\n\n    let pc: RTCPeerConnection;\n\n    try {\n      pc = new webRtc.RTCPeerConnection(Utils.defaultConfig);\n      let dc: RTCDataChannel;\n\n      try {\n        dc = pc.createDataChannel('_PEERJSTEST', { ordered: true });\n        supported.data = true;\n        supported.reliable = !!dc.ordered;\n\n        // Binary test\n        try {\n          dc.binaryType = 'blob';\n          supported.binaryBlob = true; //not works for iOS?\n        } catch (e) {}\n      } catch (e) {\n      } finally {\n        if (dc) {\n          dc.close();\n        }\n      }\n    } catch (e) {\n    } finally {\n      if (pc) {\n        pc.close();\n      }\n    }\n\n    supported.unifiedPlan = Supports.isUnifiedPlanSupported(webRtc);\n\n    return supported;\n  }\n}\n", "const LOG_PREFIX = 'PeerJS: ';\n\n/*\nPrints log messages depending on the debug level passed in. Defaults to 0.\n0  Prints no logs.\n1  Prints only errors.\n2  Prints errors and warnings.\n3  Prints all logs.\n*/\nexport enum LogLevel {\n  Disabled,\n  Errors,\n  Warnings,\n  All,\n}\n\nclass Logger {\n  private _logLevel = LogLevel.Disabled;\n\n  get logLevel(): LogLevel {\n    return this._logLevel;\n  }\n\n  set logLevel(logLevel: LogLevel) {\n    this._logLevel = logLevel;\n  }\n\n  log(...args: any[]) {\n    if (this._logLevel >= LogLevel.All) {\n      this._print(LogLevel.All, ...args);\n    }\n  }\n\n  warn(...args: any[]) {\n    if (this._logLevel >= LogLevel.Warnings) {\n      this._print(LogLevel.Warnings, ...args);\n    }\n  }\n\n  error(...args: any[]) {\n    if (this._logLevel >= LogLevel.Errors) {\n      this._print(LogLevel.Errors, ...args);\n    }\n  }\n\n  setLogFunction(fn: (logLevel: LogLevel, ..._: any[]) => void): void {\n    this._print = fn;\n  }\n\n  private _print(logLevel: LogLevel, ...rest: any[]): void {\n    const copy = [LOG_PREFIX, ...rest];\n\n    for (let i in copy) {\n      if (copy[i] instanceof Error) {\n        copy[i] = '(' + copy[i].name + ') ' + copy[i].message;\n      }\n    }\n\n    if (logLevel >= LogLevel.All) {\n      console.log(...copy);\n    } else if (logLevel >= LogLevel.Warnings) {\n      console.warn('WARNING', ...copy);\n    } else if (logLevel >= LogLevel.Errors) {\n      console.error('ERROR', ...copy);\n    }\n  }\n}\n\nexport default new Logger();\n", "import { EventEmitter } from 'eventemitter3';\nimport logger from './logger';\nimport { SocketEventType, ServerMessageType, type ConnectionType } from './enums';\nimport type { PeerJSOption } from '../index';\n\ntype MessageData = {\n  type: ServerMessageType;\n  dst: string;\n  payload: {\n    type: ConnectionType;\n    connectionId: string;\n  } & Record<string, any>;\n};\n/**\n * An abstraction on top of WebSockets to provide the fastest\n * possible connection for peers.\n */\nexport class Socket extends EventEmitter {\n  private _disconnected: boolean = true;\n  private _id: string | null = null;\n  private _messagesQueue: Array<MessageData> = [];\n  private _socket?: WebSocket;\n  private _wsPingTimer?: any;\n  private readonly _baseUrl: string;\n\n  private readonly pingInterval: number;\n  private readonly WebSocketConstructor: typeof WebSocket;\n\n  alive: boolean = false;\n\n  private _destroyed = false;\n\n  get messagesQueue(): ReadonlyArray<MessageData> {\n    return this._messagesQueue;\n  }\n\n  get destroyed() {\n    return this._destroyed;\n  }\n\n  constructor({ secure, host, port, path, key, pingInterval = 5000, polyfills }: PeerJSOption) {\n    super();\n\n    this.pingInterval = pingInterval;\n\n    const wsProtocol = secure ? 'wss://' : 'ws://';\n\n    this._baseUrl = wsProtocol + host + ':' + port + path + 'peerjs?key=' + key;\n    this.WebSocketConstructor = polyfills?.WebSocket ?? window.WebSocket;\n  }\n\n  start(id: string, token: string): void {\n    if (this._destroyed) throw new Error('Socket was destroyed!');\n\n    this._id = id;\n\n    if (!!this._socket || !this._disconnected) {\n      return;\n    }\n\n    const wsUrl = `${this._baseUrl}&id=${id}&token=${token}`;\n\n    this._socket = new this.WebSocketConstructor(wsUrl);\n    this._disconnected = false;\n\n    this._socket.onmessage = event => {\n      if (this._destroyed) return;\n\n      let data;\n\n      try {\n        data = JSON.parse(event.data);\n        logger.log('Server message received:', data);\n      } catch (e) {\n        logger.log('Invalid server message', event.data);\n        return;\n      }\n\n      this.emit(SocketEventType.Message, data);\n    };\n\n    this._socket.onclose = event => {\n      if (this._disconnected || this._destroyed) {\n        return;\n      }\n\n      logger.log('Socket closed.', event);\n\n      this._cleanup();\n      this._disconnected = true;\n\n      this.emit(SocketEventType.Disconnected);\n    };\n\n    // Take care of the queue of connections if necessary and make sure Peer knows\n    // socket is open.\n    this._socket.onopen = () => {\n      if (this._disconnected || this._destroyed) {\n        return;\n      }\n\n      logger.log('Socket open');\n\n      this.emit(SocketEventType.Open);\n\n      this._sendQueuedMessages();\n\n      this._scheduleHeartbeat();\n    };\n  }\n\n  private _scheduleHeartbeat(): void {\n    this._wsPingTimer = setTimeout(() => {\n      this._sendHeartbeat();\n    }, this.pingInterval);\n  }\n\n  private _sendHeartbeat(): void {\n    if (this._destroyed) return;\n\n    if (!this._wsOpen()) {\n      logger.log(`Cannot send heartbeat, because socket closed`);\n      return;\n    }\n\n    const message = JSON.stringify({ type: ServerMessageType.Heartbeat });\n\n    this._socket!.send(message);\n\n    this._scheduleHeartbeat();\n  }\n\n  /** Is the websocket currently open? */\n  private _wsOpen(): boolean {\n    return !!this._socket && this._socket.readyState === 1;\n  }\n\n  /** Send queued messages. */\n  private _sendQueuedMessages(): void {\n    //Create copy of queue and clear it,\n    //because send method push the message back to queue if something will go wrong\n    const copiedQueue = [...this._messagesQueue];\n    this._messagesQueue = [];\n\n    for (const message of copiedQueue) {\n      this.send(message);\n    }\n\n    if (copiedQueue.length > 0) {\n      logger.log(`${copiedQueue.length} queued messages was sent`);\n    }\n  }\n\n  /** Exposed send for DC & Peer. */\n  send(data: MessageData): void {\n    if (this._destroyed) throw new Error('Socket was destroyed!');\n\n    if (!data.type) {\n      this.emit(SocketEventType.Error, 'Invalid message');\n      return;\n    }\n\n    if (!this.alive) {\n      return;\n    }\n\n    // If we didn't get an ID yet, we can't yet send anything so we should queue\n    // up these messages.\n    if (this._id == null || !this._wsOpen()) {\n      this._messagesQueue.push(data);\n      return;\n    }\n\n    const message = JSON.stringify(data);\n\n    this._socket!.send(message);\n  }\n\n  close(): void {\n    if (this._disconnected) {\n      return;\n    }\n\n    this._cleanup();\n\n    this._id = null;\n\n    this._disconnected = true;\n  }\n\n  private _cleanup(): void {\n    if (this._socket) {\n      this._socket.onopen = this._socket.onmessage = this._socket.onclose = null;\n      this._socket.close();\n      this._socket = undefined;\n    }\n\n    clearTimeout(this._wsPingTimer!);\n  }\n\n  destroy() {\n    if (this._destroyed) return;\n\n    this.close();\n    this._messagesQueue.length = 0;\n\n    this._destroyed = true;\n  }\n}\n", "import logger from './logger';\nimport type { MediaConnection } from './mediaconnection';\nimport type { DataConnection } from './dataconnection';\nimport { ConnectionType, PeerErrorType, ConnectionEventType, ServerMessageType } from './enums';\nimport { BaseConnection } from './baseconnection';\n\nfunction noop(): void {}\n/**\n * Manages all negotiations between Peers.\n */\nexport class Negotiator {\n  constructor(readonly connection: BaseConnection) {}\n\n  private get webRtc() {\n    return this.connection.provider.options.polyfills?.WebRTC ?? window;\n  }\n\n  /** Returns a PeerConnection object set up correctly (for data, media). */\n  startConnection(options: any) {\n    const peerConnection = this._startPeerConnection();\n\n    // Set the connection's PC.\n    this.connection.peerConnection = peerConnection;\n\n    if (this.connection.type === ConnectionType.Media && options._stream) {\n      this._addTracksToConnection(options._stream, peerConnection);\n    }\n\n    // What do we need to do now?\n    if (options.originator) {\n      if (this.connection.type === ConnectionType.Data) {\n        const dataConnection = this.connection as DataConnection;\n\n        const config: RTCDataChannelInit = { ordered: !!options.reliable };\n\n        const dataChannel = peerConnection.createDataChannel(dataConnection.label, config);\n        dataConnection.initialize(dataChannel);\n      }\n\n      this._makeOffer();\n    } else {\n      this.handleSDP('OFFER', options.sdp);\n    }\n  }\n\n  /** Start a PC. */\n  private _startPeerConnection(): RTCPeerConnection {\n    logger.log('Creating RTCPeerConnection.');\n\n    const ctr: typeof RTCPeerConnection = this.webRtc.RTCPeerConnection;\n\n    const peerConnection = new ctr(this.connection.provider.options.config);\n\n    this._setupListeners(peerConnection);\n\n    return peerConnection;\n  }\n\n  /** Set up various WebRTC listeners. */\n  private _setupListeners(peerConnection: RTCPeerConnection) {\n    const peerId = this.connection.peer;\n    const connectionId = this.connection.connectionId;\n    const connectionType = this.connection.type;\n    const provider = this.connection.provider;\n\n    // ICE CANDIDATES.\n    logger.log('Listening for ICE candidates, remote streams and data channels.');\n\n    peerConnection.onicecandidate = evt => {\n      if (!evt.candidate || !evt.candidate.candidate) return;\n\n      logger.log(`Received ICE candidates for ${peerId}:`, evt.candidate);\n\n      provider.socket.send({\n        type: ServerMessageType.Candidate,\n        payload: {\n          candidate: evt.candidate,\n          type: connectionType,\n          connectionId: connectionId,\n        },\n        dst: peerId,\n      });\n    };\n\n    peerConnection.oniceconnectionstatechange = () => {\n      switch (peerConnection.iceConnectionState) {\n        case 'failed':\n          logger.log('iceConnectionState is failed, closing connections to ' + peerId);\n          this.connection.emit(\n            ConnectionEventType.Error,\n            new Error('Negotiation of connection to ' + peerId + ' failed.')\n          );\n          this.connection.close();\n          break;\n        case 'closed':\n          logger.log('iceConnectionState is closed, closing connections to ' + peerId);\n          this.connection.emit(ConnectionEventType.Error, new Error('Connection to ' + peerId + ' closed.'));\n          this.connection.close();\n          break;\n        case 'connected':\n          logger.log('iceConnectionState changed to connected on the connection with ' + peerId);\n          break;\n        case 'disconnected':\n          logger.log('iceConnectionState changed to disconnected on the connection with ' + peerId);\n          break;\n        case 'completed':\n          logger.log('iceConnectionState changed to completed on the connection with ' + peerId);\n          peerConnection.onicecandidate = noop;\n          break;\n      }\n\n      this.connection.emit(ConnectionEventType.IceStateChanged, peerConnection.iceConnectionState);\n    };\n\n    // Fired between offer and answer, so options should already be saved\n    // in the options hash.\n    peerConnection.ondatachannel = evt => {\n      logger.log('Received data channel');\n\n      const dataChannel = evt.channel;\n      const connection = provider.getConnection(peerId, connectionId) as DataConnection;\n\n      connection.initialize(dataChannel);\n    };\n\n    peerConnection.ontrack = evt => {\n      logger.log('Received remote stream');\n\n      const stream = evt.streams[0];\n      const connection = provider.getConnection(peerId, connectionId);\n\n      if (connection.type === ConnectionType.Media) {\n        const mediaConnection = connection as MediaConnection;\n\n        this._addStreamToMediaConnection(stream, mediaConnection);\n      }\n    };\n  }\n\n  cleanup(): void {\n    logger.log('Cleaning up PeerConnection to ' + this.connection.peer);\n\n    const peerConnection = this.connection.peerConnection;\n\n    if (!peerConnection) {\n      return;\n    }\n\n    this.connection.peerConnection = null;\n\n    //unsubscribe from all PeerConnection's events\n    peerConnection.onicecandidate =\n      peerConnection.oniceconnectionstatechange =\n      peerConnection.ondatachannel =\n      peerConnection.ontrack =\n        null;\n\n    const peerConnectionNotClosed = peerConnection.signalingState !== 'closed';\n    let dataChannelNotClosed = false;\n\n    if (this.connection.type === ConnectionType.Data) {\n      const dataConnection = this.connection as DataConnection;\n      const dataChannel = dataConnection.dataChannel;\n\n      if (dataChannel) {\n        dataChannelNotClosed = !!dataChannel.readyState && dataChannel.readyState !== 'closed';\n      }\n    }\n\n    if (peerConnectionNotClosed || dataChannelNotClosed) {\n      peerConnection.close();\n    }\n  }\n\n  private async _makeOffer(): Promise<void> {\n    const peerConnection = this.connection.peerConnection;\n    const provider = this.connection.provider;\n\n    try {\n      const offer = await peerConnection.createOffer(this.connection.options.constraints);\n\n      if (peerConnection.signalingState === 'closed') return;\n\n      logger.log('Created offer.');\n\n      if (this.connection.options.sdpTransform && typeof this.connection.options.sdpTransform === 'function') {\n        offer.sdp = this.connection.options.sdpTransform(offer.sdp) || offer.sdp;\n      }\n\n      try {\n        await peerConnection.setLocalDescription(offer);\n\n        logger.log('Set localDescription:', offer, `for:${this.connection.peer}`);\n\n        let payload: any = {\n          sdp: offer,\n          type: this.connection.type,\n          connectionId: this.connection.connectionId,\n          metadata: this.connection.metadata,\n        };\n\n        if (this.connection.type === ConnectionType.Data) {\n          const dataConnection = this.connection as DataConnection;\n\n          payload = {\n            ...payload,\n            label: dataConnection.label,\n            reliable: dataConnection.reliable,\n            serialization: dataConnection.serialization,\n          };\n        }\n\n        provider.socket.send({\n          type: ServerMessageType.Offer,\n          payload,\n          dst: this.connection.peer,\n        });\n      } catch (err) {\n        // TODO: investigate why _makeOffer is being called from the answer\n        if (err != 'OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer') {\n          provider.emitError(PeerErrorType.WebRTC, err);\n          logger.log('Failed to setLocalDescription, ', err);\n        }\n      }\n    } catch (err_1) {\n      provider.emitError(PeerErrorType.WebRTC, err_1);\n      logger.log('Failed to createOffer, ', err_1);\n    }\n  }\n\n  private async _makeAnswer(): Promise<void> {\n    const peerConnection = this.connection.peerConnection;\n    const provider = this.connection.provider;\n\n    try {\n      const answer = await peerConnection.createAnswer();\n\n      if (peerConnection.signalingState === 'closed') return;\n\n      logger.log('Created answer.');\n\n      if (this.connection.options.sdpTransform && typeof this.connection.options.sdpTransform === 'function') {\n        answer.sdp = this.connection.options.sdpTransform(answer.sdp) || answer.sdp;\n      }\n\n      try {\n        await peerConnection.setLocalDescription(answer);\n\n        logger.log(`Set localDescription:`, answer, `for:${this.connection.peer}`);\n\n        provider.socket.send({\n          type: ServerMessageType.Answer,\n          payload: {\n            sdp: answer,\n            type: this.connection.type,\n            connectionId: this.connection.connectionId,\n          },\n          dst: this.connection.peer,\n        });\n      } catch (err) {\n        provider.emitError(PeerErrorType.WebRTC, err);\n        logger.log('Failed to setLocalDescription, ', err);\n      }\n    } catch (err_1) {\n      provider.emitError(PeerErrorType.WebRTC, err_1);\n      logger.log('Failed to create answer, ', err_1);\n    }\n  }\n\n  /** Handle an SDP. */\n  async handleSDP(type: string, sdp: any): Promise<void> {\n    const ctr: typeof RTCSessionDescription = this.webRtc.RTCSessionDescription;\n\n    sdp = new ctr(sdp);\n    const peerConnection = this.connection.peerConnection;\n    const provider = this.connection.provider;\n\n    logger.log('Setting remote description', sdp);\n\n    const self = this;\n\n    try {\n      await peerConnection.setRemoteDescription(sdp);\n      logger.log(`Set remoteDescription:${type} for:${this.connection.peer}`);\n      if (type === 'OFFER') {\n        await self._makeAnswer();\n      }\n    } catch (err) {\n      provider.emitError(PeerErrorType.WebRTC, err);\n      logger.log('Failed to setRemoteDescription, ', err);\n    }\n  }\n\n  /** Handle a candidate. */\n  async handleCandidate(ice: any): Promise<void> {\n    logger.log(`handleCandidate:`, ice);\n\n    const candidate = ice.candidate;\n    const sdpMLineIndex = ice.sdpMLineIndex;\n    const sdpMid = ice.sdpMid;\n    const peerConnection = this.connection.peerConnection;\n    const provider = this.connection.provider;\n\n    try {\n      const ctr: typeof RTCIceCandidate = this.webRtc.RTCIceCandidate;\n\n      await peerConnection.addIceCandidate(\n        new ctr({\n          sdpMid: sdpMid,\n          sdpMLineIndex: sdpMLineIndex,\n          candidate: candidate,\n        })\n      );\n      logger.log(`Added ICE candidate for:${this.connection.peer}`);\n    } catch (err) {\n      provider.emitError(PeerErrorType.WebRTC, err);\n      logger.log('Failed to handleCandidate, ', err);\n    }\n  }\n\n  private _addTracksToConnection(stream: MediaStream, peerConnection: RTCPeerConnection): void {\n    logger.log(`add tracks from stream ${stream.id} to peer connection`);\n\n    if (!peerConnection.addTrack) {\n      return logger.error(`Your browser does't support RTCPeerConnection#addTrack. Ignored.`);\n    }\n\n    stream.getTracks().forEach(track => {\n      peerConnection.addTrack(track, stream);\n    });\n  }\n\n  private _addStreamToMediaConnection(stream: MediaStream, mediaConnection: MediaConnection): void {\n    logger.log(`add stream ${stream.id} to media connection ${mediaConnection.connectionId}`);\n\n    mediaConnection.addStream(stream);\n  }\n}\n", "import { EventEmitter } from 'eventemitter3';\nimport type { Peer } from './peer';\nimport type { ServerMessage } from './servermessage';\nimport type { ConnectionType } from './enums';\n\nexport abstract class BaseConnection extends EventEmitter {\n  protected _open = false;\n\n  readonly metadata: any;\n  connectionId: string;\n\n  peerConnection: RTCPeerConnection;\n\n  abstract get type(): ConnectionType;\n\n  get open() {\n    return this._open;\n  }\n\n  constructor(readonly peer: string, public provider: Peer, readonly options: any) {\n    super();\n\n    this.metadata = options.metadata;\n  }\n\n  abstract close(): void;\n\n  abstract handleMessage(message: ServerMessage): void;\n}\n", "import { Utils } from './utils';\nimport logger from './logger';\nimport { Negotiator } from './negotiator';\nimport { ConnectionType, ConnectionEventType, ServerMessageType } from './enums';\nimport type { Peer } from './peer';\nimport { BaseConnection } from './baseconnection';\nimport type { ServerMessage } from './servermessage';\nimport type { AnswerOption } from '..';\n\n/**\n * Wraps the streaming interface between two Peers.\n */\nexport class MediaConnection extends BaseConnection {\n  private static readonly ID_PREFIX = 'mc_';\n\n  private _negotiator: Negotiator;\n  private _localStream: MediaStream;\n  private _remoteStream: MediaStream;\n\n  get type() {\n    return ConnectionType.Media;\n  }\n\n  get localStream(): MediaStream {\n    return this._localStream;\n  }\n  get remoteStream(): MediaStream {\n    return this._remoteStream;\n  }\n\n  constructor(peerId: string, provider: Peer, options: any) {\n    super(peerId, provider, options);\n\n    this._localStream = this.options._stream;\n    this.connectionId = this.options.connectionId || MediaConnection.ID_PREFIX + Utils.randomToken();\n\n    this._negotiator = new Negotiator(this);\n\n    if (this._localStream) {\n      this._negotiator.startConnection({\n        _stream: this._localStream,\n        originator: true,\n      });\n    }\n  }\n\n  addStream(remoteStream) {\n    logger.log('Receiving stream', remoteStream);\n\n    this._remoteStream = remoteStream;\n    super.emit(ConnectionEventType.Stream, remoteStream); // Should we call this `open`?\n  }\n\n  handleMessage(message: ServerMessage): void {\n    const type = message.type;\n    const payload = message.payload;\n\n    switch (message.type) {\n      case ServerMessageType.Answer:\n        // Forward to negotiator\n        this._negotiator.handleSDP(type, payload.sdp);\n        this._open = true;\n        break;\n      case ServerMessageType.Candidate:\n        this._negotiator.handleCandidate(payload.candidate);\n        break;\n      default:\n        logger.warn(`Unrecognized message type:${type} from peer:${this.peer}`);\n        break;\n    }\n  }\n\n  answer(stream: MediaStream, options: AnswerOption = {}): void {\n    if (this._localStream) {\n      logger.warn('Local stream already exists on this MediaConnection. Are you answering a call twice?');\n      return;\n    }\n\n    this._localStream = stream;\n\n    if (options && options.sdpTransform) {\n      this.options.sdpTransform = options.sdpTransform;\n    }\n\n    this._negotiator.startConnection({ ...this.options._payload, _stream: stream });\n    // Retrieve lost messages stored because PeerConnection not set up.\n    const messages = this.provider._getMessages(this.connectionId);\n\n    for (let message of messages) {\n      this.handleMessage(message);\n    }\n\n    this._open = true;\n  }\n\n  /**\n   * Exposed functionality for users.\n   */\n\n  /** Allows user to close connection. */\n  close(): void {\n    if (this._negotiator) {\n      this._negotiator.cleanup();\n      this._negotiator = null;\n    }\n\n    this._localStream = null;\n    this._remoteStream = null;\n\n    if (this.provider) {\n      this.provider._removeConnection(this);\n\n      this.provider = null;\n    }\n\n    if (this.options && this.options._stream) {\n      this.options._stream = null;\n    }\n\n    if (!this.open) {\n      return;\n    }\n\n    this._open = false;\n\n    super.emit(ConnectionEventType.Close);\n  }\n}\n", "import { EventEmitter } from 'eventemitter3';\nimport logger from './logger';\n\nexport class EncodingQueue extends EventEmitter {\n  private _queue: Blob[] = [];\n  private _processing: boolean = false;\n\n  constructor(private readonly fileReader: FileReader) {\n    super();\n\n    this.fileReader.onload = evt => {\n      this._processing = false;\n\n      if (evt.target) {\n        this.emit('done', evt.target.result as ArrayBuffer);\n      }\n\n      this.doNextTask();\n    };\n\n    this.fileReader.onerror = evt => {\n      logger.error(`EncodingQueue error:`, evt);\n      this._processing = false;\n      this.destroy();\n      this.emit('error', evt);\n    };\n  }\n\n  get queue(): Blob[] {\n    return this._queue;\n  }\n\n  get size(): number {\n    return this.queue.length;\n  }\n\n  get processing(): boolean {\n    return this._processing;\n  }\n\n  enque(blob: Blob): void {\n    this.queue.push(blob);\n\n    if (this.processing) return;\n\n    this.doNextTask();\n  }\n\n  destroy(): void {\n    this.fileReader.abort();\n    this._queue = [];\n  }\n\n  private doNextTask(): void {\n    if (this.size === 0) return;\n    if (this.processing) return;\n\n    this._processing = true;\n\n    this.fileReader.readAsArrayBuffer(this.queue.shift());\n  }\n}\n", "import { Utils } from './utils';\nimport logger from './logger';\nimport { Negotiator } from './negotiator';\nimport { ConnectionType, ConnectionEventType, SerializationType, ServerMessageType } from './enums';\nimport type { Peer } from './peer';\nimport { BaseConnection } from './baseconnection';\nimport type { ServerMessage } from './servermessage';\nimport { EncodingQueue } from './encodingQueue';\nimport type { DataConnection as IDataConnection } from '../index';\n\n/**\n * Wraps a DataChannel between two Peers.\n */\nexport class DataConnection extends BaseConnection implements IDataConnection {\n  private static readonly ID_PREFIX = 'dc_';\n  private static readonly MAX_BUFFERED_AMOUNT = 8 * 1024 * 1024;\n\n  private _negotiator: Negotiator;\n  readonly label: string;\n  readonly serialization: SerializationType;\n  readonly reliable: boolean;\n  stringify: (data: any) => string = JSON.stringify;\n  parse: (data: string) => any = JSON.parse;\n\n  get type() {\n    return ConnectionType.Data;\n  }\n\n  private _buffer: any[] = [];\n  private _bufferSize = 0;\n  private _buffering = false;\n  private _chunkedData: {\n    [id: number]: {\n      data: Blob[];\n      count: number;\n      total: number;\n    };\n  } = {};\n\n  private _dc: RTCDataChannel;\n  private _encodingQueue: EncodingQueue;\n\n  get dataChannel(): RTCDataChannel {\n    return this._dc;\n  }\n\n  get bufferSize(): number {\n    return this._bufferSize;\n  }\n\n  private readonly FileReaderCtr: typeof FileReader;\n\n  constructor(peerId: string, provider: Peer, options: any) {\n    super(peerId, provider, options);\n\n    this.connectionId = this.options.connectionId || DataConnection.ID_PREFIX + Utils.randomToken();\n\n    this.label = this.options.label || this.connectionId;\n    this.serialization = this.options.serialization || SerializationType.Binary;\n    this.reliable = !!this.options.reliable;\n\n    this.FileReaderCtr = provider.options.polyfills?.FileReader ?? window.FileReader;\n\n    this._encodingQueue = new EncodingQueue(new this.FileReaderCtr());\n\n    this._encodingQueue.on('done', (ab: ArrayBuffer) => {\n      this._bufferedSend(ab);\n    });\n\n    this._encodingQueue.on('error', () => {\n      logger.error(`DC#${this.connectionId}: Error occured in encoding from blob to arraybuffer, close DC`);\n      this.close();\n    });\n\n    this._negotiator = new Negotiator(this);\n\n    this._negotiator.startConnection(\n      this.options._payload || {\n        originator: true,\n      }\n    );\n  }\n\n  /** Called by the Negotiator when the DataChannel is ready. */\n  initialize(dc: RTCDataChannel): void {\n    this._dc = dc;\n    this._configureDataChannel();\n  }\n\n  private _configureDataChannel(): void {\n    if (!this.provider.features.binaryBlob || this.provider.features.reliable) {\n      this.dataChannel.binaryType = 'arraybuffer';\n    }\n\n    this.dataChannel.onopen = () => {\n      logger.log(`DC#${this.connectionId} dc connection success`);\n      this._open = true;\n      this.emit(ConnectionEventType.Open);\n    };\n\n    this.dataChannel.onmessage = e => {\n      logger.log(`DC#${this.connectionId} dc onmessage:`, e.data);\n      this._handleDataMessage(e);\n    };\n\n    this.dataChannel.onclose = () => {\n      logger.log(`DC#${this.connectionId} dc closed for:`, this.peer);\n      this.close();\n    };\n  }\n\n  // Handles a DataChannel message.\n  private _handleDataMessage({ data }: { data: Blob | ArrayBuffer | string }): void {\n    const datatype = data.constructor;\n\n    const isBinarySerialization =\n      this.serialization === SerializationType.Binary || this.serialization === SerializationType.BinaryUTF8;\n\n    let deserializedData: any = data;\n\n    if (isBinarySerialization) {\n      if (datatype === Blob) {\n        // Datatype should never be Blob\n        Utils.blobToArrayBuffer(this.FileReaderCtr, data as Blob, ab => {\n          const unpackedData = Utils.unpack(ab);\n          this.emit(ConnectionEventType.Data, unpackedData);\n        });\n        return;\n      } else if (datatype === ArrayBuffer) {\n        deserializedData = Utils.unpack(data as ArrayBuffer);\n      } else if (datatype === String) {\n        // String fallback for binary data for browsers that don't support binary yet\n        const ab = Utils.binaryStringToArrayBuffer(data as string);\n        deserializedData = Utils.unpack(ab);\n      }\n    } else if (this.serialization === SerializationType.JSON) {\n      deserializedData = this.parse(data as string);\n    }\n\n    // Check if we've chunked--if so, piece things back together.\n    // We're guaranteed that this isn't 0.\n    if (deserializedData.__peerData) {\n      this._handleChunk(deserializedData);\n      return;\n    }\n\n    super.emit(ConnectionEventType.Data, deserializedData);\n  }\n\n  private _handleChunk(data: { __peerData: number; n: number; total: number; data: Blob }): void {\n    const id = data.__peerData;\n    const chunkInfo = this._chunkedData[id] || {\n      data: [],\n      count: 0,\n      total: data.total,\n    };\n\n    chunkInfo.data[data.n] = data.data;\n    chunkInfo.count++;\n    this._chunkedData[id] = chunkInfo;\n\n    if (chunkInfo.total === chunkInfo.count) {\n      // Clean up before making the recursive call to `_handleDataMessage`.\n      delete this._chunkedData[id];\n\n      // We've received all the chunks--time to construct the complete data.\n      const data = new Blob(chunkInfo.data);\n      this._handleDataMessage({ data });\n    }\n  }\n\n  /**\n   * Exposed functionality for users.\n   */\n\n  /** Allows user to close connection. */\n  close(): void {\n    this._buffer = [];\n    this._bufferSize = 0;\n    this._chunkedData = {};\n\n    if (this._negotiator) {\n      this._negotiator.cleanup();\n      this._negotiator = null;\n    }\n\n    if (this.provider) {\n      this.provider._removeConnection(this);\n\n      this.provider = null;\n    }\n\n    if (this.dataChannel) {\n      this.dataChannel.onopen = null;\n      this.dataChannel.onmessage = null;\n      this.dataChannel.onclose = null;\n      this._dc = null;\n    }\n\n    if (this._encodingQueue) {\n      this._encodingQueue.destroy();\n      this._encodingQueue.removeAllListeners();\n      this._encodingQueue = null;\n    }\n\n    if (!this.open) {\n      return;\n    }\n\n    this._open = false;\n\n    super.emit(ConnectionEventType.Close);\n  }\n\n  /** Allows user to send data. */\n  send(data: any, chunked?: boolean): void {\n    if (!this.open) {\n      super.emit(\n        ConnectionEventType.Error,\n        new Error('Connection is not open. You should listen for the `open` event before sending messages.')\n      );\n      return;\n    }\n\n    if (this.serialization === SerializationType.JSON) {\n      this._bufferedSend(this.stringify(data));\n    } else if (this.serialization === SerializationType.Binary || this.serialization === SerializationType.BinaryUTF8) {\n      const blob = Utils.pack(data);\n\n      if (!chunked && blob.size > Utils.chunkedMTU) {\n        this._sendChunks(blob);\n        return;\n      }\n\n      if (!this.provider.features.binaryBlob) {\n        // We only do this if we really need to (e.g. blobs are not supported),\n        // because this conversion is costly.\n        this._encodingQueue.enque(blob);\n      } else {\n        this._bufferedSend(blob);\n      }\n    } else {\n      this._bufferedSend(data);\n    }\n  }\n\n  private _bufferedSend(msg: any): void {\n    if (this._buffering || !this._trySend(msg)) {\n      this._buffer.push(msg);\n      this._bufferSize = this._buffer.length;\n    }\n  }\n\n  // Returns true if the send succeeds.\n  private _trySend(msg: any): boolean {\n    if (!this.open) {\n      return false;\n    }\n\n    if (this.dataChannel.bufferedAmount > DataConnection.MAX_BUFFERED_AMOUNT) {\n      this._buffering = true;\n      setTimeout(() => {\n        this._buffering = false;\n        this._tryBuffer();\n      }, 50);\n\n      return false;\n    }\n\n    try {\n      this.dataChannel.send(msg);\n    } catch (e) {\n      logger.error(`DC#:${this.connectionId} Error when sending:`, e);\n      this._buffering = true;\n\n      this.close();\n\n      return false;\n    }\n\n    return true;\n  }\n\n  // Try to send the first message in the buffer.\n  private _tryBuffer(): void {\n    if (!this.open) {\n      return;\n    }\n\n    if (this._buffer.length === 0) {\n      return;\n    }\n\n    const msg = this._buffer[0];\n\n    if (this._trySend(msg)) {\n      this._buffer.shift();\n      this._bufferSize = this._buffer.length;\n      this._tryBuffer();\n    }\n  }\n\n  private _sendChunks(blob: Blob): void {\n    const blobs = Utils.chunk(blob);\n    logger.log(`DC#${this.connectionId} Try to send ${blobs.length} chunks...`);\n\n    for (let blob of blobs) {\n      this.send(blob, true);\n    }\n  }\n\n  handleMessage(message: ServerMessage): void {\n    const payload = message.payload;\n\n    switch (message.type) {\n      case ServerMessageType.Answer:\n        this._negotiator.handleSDP(message.type, payload.sdp);\n        break;\n      case ServerMessageType.Candidate:\n        this._negotiator.handleCandidate(payload.candidate);\n        break;\n      default:\n        logger.warn('Unrecognized message type:', message.type, 'from peer:', this.peer);\n        break;\n    }\n  }\n}\n", "import { Utils } from './utils';\nimport logger from './logger';\nimport { PeerJSOption } from '..';\n\nexport class API {\n  constructor(private readonly _options: PeerJSOption) {}\n\n  private _request(url: string) {\n    return (this._options.polyfills?.fetch ?? window.fetch)(url);\n  }\n\n  private _buildUrl(method: string): string {\n    const protocol = this._options.secure ? 'https://' : 'http://';\n    let url =\n      protocol + this._options.host + ':' + this._options.port + this._options.path + this._options.key + '/' + method;\n    const queryString = '?ts=' + new Date().getTime() + '' + Math.random();\n    url += queryString;\n\n    return url;\n  }\n\n  /** Get a unique ID from the server via XHR and initialize with it. */\n  async retrieveId(): Promise<string> {\n    const url = this._buildUrl('id');\n\n    try {\n      const response = await this._request(url);\n\n      if (response.status !== 200) {\n        throw new Error(`Error. Status:${response.status}`);\n      }\n\n      return response.text();\n    } catch (error) {\n      logger.error('Error retrieving ID', error);\n\n      let pathError = '';\n\n      if (this._options.path === '/' && this._options.host !== Utils.CLOUD_HOST) {\n        pathError =\n          ' If you passed in a `path` to your self-hosted PeerServer, ' +\n          \"you'll also need to pass in that same path when creating a new \" +\n          'Peer.';\n      }\n\n      throw new Error('Could not get an ID from the server.' + pathError);\n    }\n  }\n\n  /** @deprecated */\n  async listAllPeers(): Promise<any[]> {\n    const url = this._buildUrl('peers');\n\n    try {\n      const response = await this._request(url);\n\n      if (response.status !== 200) {\n        if (response.status === 401) {\n          let helpfulError = '';\n\n          if (this._options.host === Utils.CLOUD_HOST) {\n            helpfulError =\n              \"It looks like you're using the cloud server. You can email \" +\n              'team@peerjs.com to enable peer listing for your API key.';\n          } else {\n            helpfulError =\n              'You need to enable `allow_discovery` on your self-hosted ' + 'PeerServer to use this feature.';\n          }\n\n          throw new Error(\"It doesn't look like you have permission to list peers IDs. \" + helpfulError);\n        }\n\n        throw new Error(`Error. Status:${response.status}`);\n      }\n\n      return response.json();\n    } catch (error) {\n      logger.error('Error retrieving list peers', error);\n\n      throw new Error('Could not get list peers from the server.' + error);\n    }\n  }\n}\n", "export const Supports = {\n  isUnifiedPlanSupported(webRtc: any): boolean {\n    if (!webRtc && typeof window !== 'undefined') {\n      webRtc = window;\n    }\n\n    if (\n      typeof webRtc.RTCRtpTransceiver === 'undefined' ||\n      !('currentDirection' in webRtc.RTCRtpTransceiver.prototype)\n    ) {\n      return false;\n    }\n\n    let tempPc: RTCPeerConnection;\n    let supported = false;\n\n    try {\n      tempPc = new webRtc.RTCPeerConnection();\n      tempPc.addTransceiver('audio');\n      supported = true;\n    } catch (e) {\n    } finally {\n      if (tempPc) {\n        tempPc.close();\n      }\n    }\n\n    return supported;\n  },\n} as const;\n", "import { Utils } from './utils';\nimport { Peer } from './peer';\n\nexport { Peer, Utils };\n\nexport default Peer;\n\nif (typeof window !== 'undefined') {\n  // @ts-expect-error\n  window.Peer = Peer;\n}\n"],
  "mappings": "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",
  "names": []
}
